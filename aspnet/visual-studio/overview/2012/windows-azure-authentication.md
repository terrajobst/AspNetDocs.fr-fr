---
uid: visual-studio/overview/2012/windows-azure-authentication
title: Authentification Windows Azure | Microsoft Docs
author: Rick-Anderson
description: Microsoft ASP.NET Tools pour Windows Azure Active Directory facilite l’activation de l’authentification pour les applications Web hébergées sur des sites Web Windows Azure...
ms.author: riande
ms.date: 02/20/2013
ms.assetid: a3cef801-a54b-4ebd-93c3-55764e2e14b1
msc.legacyurl: /visual-studio/overview/2012/windows-azure-authentication
msc.type: authoredcontent
ms.openlocfilehash: ce98effe18dd739504fb0d5453bae8a46c3ba102
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457477"
---
# <a name="windows-azure-authentication"></a><span data-ttu-id="d8d91-103">Authentification Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d8d91-103">Windows Azure Authentication</span></span>

<span data-ttu-id="d8d91-104">par [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="d8d91-104">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="d8d91-105">Microsoft ASP.NET Tools pour Windows Azure Active Directory facilite l’activation de l’authentification pour les applications Web hébergées sur des [sites Web Windows Azure](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="d8d91-105">Microsoft ASP.NET tools for Windows Azure Active Directory makes it simple to enable authentication for web applications hosted on [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="d8d91-106">Vous pouvez utiliser l’authentification Windows Azure pour authentifier les utilisateurs Office 365 de votre organisation, les comptes d’entreprise synchronisés à partir de votre Active Directory local ou les utilisateurs créés dans votre propre domaine Windows Azure Active Directory personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d8d91-106">You can use Windows Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Windows Azure Active Directory domain.</span></span> <span data-ttu-id="d8d91-107">L’activation de l’authentification Windows Azure configure votre application pour authentifier les utilisateurs à l’aide d’un seul locataire [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) .</span><span class="sxs-lookup"><span data-stu-id="d8d91-107">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
>
> <span data-ttu-id="d8d91-108">L’outil d’authentification Windows Azure ASP.NET n’est pas pris en charge pour les rôles Web dans un service Cloud, mais nous envisageons de le faire dans une version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="d8d91-108">The ASP.NET Windows Azure Authentication tool is not supported for web roles in a cloud service but we plan to do so in a future release.</span></span> <span data-ttu-id="d8d91-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) est pris en charge dans les rôles Web Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="d8d91-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) is supported in Windows Azure web roles.</span></span>
>
> <span data-ttu-id="d8d91-110">Pour plus d’informations sur la configuration de la synchronisation entre votre Active Directory sur site et votre client Windows Azure Active Directory, consultez la page [utilisation de AD FS 2,0 pour implémenter et gérer l’authentification unique](https://technet.microsoft.com/library/jj205462.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d91-110">For details on how to setup synchronization between your on-premise Active Directory and your Windows Azure Active Directory tenant please see [Use AD FS 2.0 to implement and manage single sign-on](https://technet.microsoft.com/library/jj205462.aspx).</span></span>
>
> <span data-ttu-id="d8d91-111">Windows Azure Active Directory est actuellement disponible en version [préliminaire gratuite](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="d8d91-111">Windows Azure Active Directory is currently available as a [free preview service](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="requirements"></a><span data-ttu-id="d8d91-112">Conditions requises :</span><span class="sxs-lookup"><span data-stu-id="d8d91-112">Requirements:</span></span>

- <span data-ttu-id="d8d91-113">Visual Studio 2012 ou [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span><span class="sxs-lookup"><span data-stu-id="d8d91-113">Visual Studio 2012 or [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span></span>
- <span data-ttu-id="d8d91-114">Extensions [Web Tools pour Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) ou [Extensions web tools pour Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="d8d91-114">[Web Tools Extensions for Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) or [Web Tools Extensions for Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span></span>
- <span data-ttu-id="d8d91-115">[Outils Microsoft ASP.net pour windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) ou [Microsoft ASP.net tools pour windows Azure Active Directory – Visual Studio Express 2012 pour le Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span><span class="sxs-lookup"><span data-stu-id="d8d91-115">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) or [Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio Express 2012 for Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span></span>

## <a name="create-an-aspnet-web-application-with-visual-studio-2012"></a><span data-ttu-id="d8d91-116">Créer une application Web ASP.NET avec Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="d8d91-116">Create an ASP.NET Web Application with Visual Studio 2012</span></span>

<span data-ttu-id="d8d91-117">Vous pouvez créer n’importe quelle application Web avec Visual Studio 2012, ce didacticiel utilise le modèle intranet MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d8d91-117">You can create any Web Application with Visual Studio 2012, this tutorial uses the ASP.NET MVC intranet template.</span></span>

1. <span data-ttu-id="d8d91-118">Créez une nouvelle application intranet ASP.NET MVC 4 et acceptez toutes les valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="d8d91-118">Create a new ASP.NET MVC 4 Intranet Application and accept all the defaults.</span></span> <span data-ttu-id="d8d91-119">(Il doit s’agir d’une opération in **tra** net et non du projet **RET** net).</span><span class="sxs-lookup"><span data-stu-id="d8d91-119">(It must be an In **tra** net and not In **ter** net project).</span></span>
     ![](windows-azure-authentication/_static/image1.png)

## <a name="enable-window-azure-authentication-when-you-are-a-global-administrator-of-the-tenet"></a><span data-ttu-id="d8d91-120">Activer l’authentification Windows Azure (lorsque vous êtes un administrateur général du principe général)</span><span class="sxs-lookup"><span data-stu-id="d8d91-120">Enable Window Azure Authentication (When you are a Global Administrator of the Tenet)</span></span>

<span data-ttu-id="d8d91-121">Si vous n’avez pas de locataire Windows Azure Active Directory existant (par exemple, via un compte Office 365 existant), vous pouvez créer un locataire en vous inscrivant pour obtenir un [nouveau compte Windows Azure Active Directory](https://g.microsoftonline.com/0AX00en/5).</span><span class="sxs-lookup"><span data-stu-id="d8d91-121">If you do not have an existing Windows Azure Active Directory tenant (For example, through an existing Office 365 account) you can create a new tenant by signing up for a [new Windows Azure Active Directory account](https://g.microsoftonline.com/0AX00en/5).</span></span>

1. <span data-ttu-id="d8d91-122">Dans le menu projet, sélectionnez **activer l’authentification Windows Azure**:</span><span class="sxs-lookup"><span data-stu-id="d8d91-122">From the Project menu select **Enable Windows Azure Authentication**:</span></span>

   ![](windows-azure-authentication/_static/image2.png)

2. <span data-ttu-id="d8d91-123">Entrez le domaine de votre locataire Windows Azure Active Directory (par exemple, contoso.onmicrosoft.com), puis cliquez sur **activer**:</span><span class="sxs-lookup"><span data-stu-id="d8d91-123">Enter the domain for your Windows Azure Active Directory tenant (for example, contoso.onmicrosoft.com) and click **Enable**:</span></span>

![](windows-azure-authentication/_static/image3.png)

3. <span data-ttu-id="d8d91-124">Dans la boîte de dialogue authentification Web, connectez-vous en tant qu’administrateur de votre locataire Windows Azure Active Directory :</span><span class="sxs-lookup"><span data-stu-id="d8d91-124">In the Web Authentication dialog sign in as an administrator for your Windows Azure Active Directory tenant:</span></span>

   ![](windows-azure-authentication/_static/image4.png)

![](windows-azure-authentication/_static/image5.png)

## <a name="enable-window-azure-by-a-non-administrator-of-the-tenet"></a><span data-ttu-id="d8d91-125">Activer Windows Azure par un non-administrateur du principe</span><span class="sxs-lookup"><span data-stu-id="d8d91-125">Enable Window Azure by a non-administrator of the Tenet</span></span>

<span data-ttu-id="d8d91-126">Si vous ne disposez pas de privilèges d’administrateur général pour votre locataire Windows Azure Active Directory, vous pouvez désactiver la case à cocher pour approvisionner l’application.</span><span class="sxs-lookup"><span data-stu-id="d8d91-126">If you do not have Global Administrator privilege for your Windows Azure Active Directory tenant, you can uncheck the checkbox for provisioning the application.</span></span>

![](windows-azure-authentication/_static/image6.png)

<span data-ttu-id="d8d91-127">La boîte de dialogue affiche le **domaine**, l' **ID du principal** de l’application et l' **URL de réponse** , qui sont nécessaires à l’approvisionnement de l’application avec un Azure Active Directory principe.</span><span class="sxs-lookup"><span data-stu-id="d8d91-127">The dialog will display the **Domain**, **Application Principal Id** and **Reply URL** which are required for provisioning the application with an Azure Active Directory tenet.</span></span> <span data-ttu-id="d8d91-128">Vous devez fournir ces informations à une personne disposant des privilèges suffisants pour approvisionner l’application.</span><span class="sxs-lookup"><span data-stu-id="d8d91-128">You need to give this information to someone who has sufficient privilege to provision the application.</span></span> <span data-ttu-id="d8d91-129">Pour plus d’informations sur l’utilisation de l’applet de commande pour créer manuellement le principal du service[, consultez Comment implémenter l’authentification unique avec Windows Azure Active Directory-Application ASP.net](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) .</span><span class="sxs-lookup"><span data-stu-id="d8d91-129">See[How to implement single sign-on with Windows Azure Active Directory - ASP.NET Application](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) for details on how to use cmdlet to create the service principal manually.</span></span>
<span data-ttu-id="d8d91-130">Une fois l’application configurée, vous pouvez cliquer sur **continuer pour mettre à jour le fichier Web. config avec les paramètres sélectionnés**.</span><span class="sxs-lookup"><span data-stu-id="d8d91-130">Once the application has been successfully provisioned, you can click on **Continue to update web.config with the selected settings**.</span></span> <span data-ttu-id="d8d91-131">Si vous souhaitez poursuivre le développement de l’application en attendant que l’approvisionnement se produise, vous pouvez cliquer sur **Fermer pour vous souvenir des paramètres du fichier projet**.</span><span class="sxs-lookup"><span data-stu-id="d8d91-131">If you want to continue developing the application while waiting for provisioning to happen, you can click **Close to remember the settings in project file**.</span></span> <span data-ttu-id="d8d91-132">La prochaine fois que vous appelez activer l’authentification Windows Azure et décochez la case de configuration, vous verrez les mêmes paramètres. vous pouvez cliquer sur **Continuer**, puis sur **appliquer ces paramètres dans le fichier Web. config**.</span><span class="sxs-lookup"><span data-stu-id="d8d91-132">The next time you invoke Enable Windows Azure Authentication and uncheck the provisioning checkbox, you will see the same settings and you can click **Continue**, then click, **Apply these settings in web.config**.</span></span>

1. <span data-ttu-id="d8d91-133">Attendez que votre application soit configurée pour l’authentification Windows Azure et approvisionnée avec Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d8d91-133">Wait while your application is configured for Windows Azure Authentication and provisioned with Windows Azure Active Directory.</span></span>
2. <span data-ttu-id="d8d91-134">Une fois l’authentification Windows Azure activée pour votre application, cliquez sur **Fermer :**</span><span class="sxs-lookup"><span data-stu-id="d8d91-134">Once Windows Azure Authentication has been enabled for your application, click **Close:**</span></span>

    ![](windows-azure-authentication/_static/image7.png)
3. <span data-ttu-id="d8d91-135">Appuyez sur F5 pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="d8d91-135">Hit F5 to run your application.</span></span> <span data-ttu-id="d8d91-136">Vous devez automatiquement être redirigé vers la page de connexion.</span><span class="sxs-lookup"><span data-stu-id="d8d91-136">You should automatically get redirected to login page.</span></span> <span data-ttu-id="d8d91-137">Utilisez les informations d’identification de l’utilisateur Directory-principes pour vous connecter à l’application.</span><span class="sxs-lookup"><span data-stu-id="d8d91-137">Use the directory tenet user credentials to login to the application..</span></span>

    ![](windows-azure-authentication/_static/image1.jpg)
4. <span data-ttu-id="d8d91-138">Étant donné que votre application utilise actuellement un certificat de test auto-signé, vous recevrez un avertissement du navigateur indiquant que le certificat n’a pas été émis par une autorité de certification approuvée.</span><span class="sxs-lookup"><span data-stu-id="d8d91-138">Because your application is currently using a self-signed test certificate you will receive a warning from the browser that the certificate was not issued by a trusted certificate authority.</span></span>

    <span data-ttu-id="d8d91-139">Cet avertissement peut être ignoré en toute sécurité pendant le développement local en cliquant sur **Continuer sur ce site Web :**</span><span class="sxs-lookup"><span data-stu-id="d8d91-139">This warning can be safely ignored during local development by clicking **Continue to this website:**</span></span>

    ![](windows-azure-authentication/_static/image8.png)
5. <span data-ttu-id="d8d91-140">Vous avez maintenant réussi à vous connecter à votre application à l’aide de l’authentification Windows Azure !</span><span class="sxs-lookup"><span data-stu-id="d8d91-140">You have now successfully logged in to your application using Windows Azure Authentication!</span></span>

    ![](windows-azure-authentication/_static/image2.jpg)

<span data-ttu-id="d8d91-141">L’activation de l’authentification Windows Azure apporte les modifications suivantes à votre application :</span><span class="sxs-lookup"><span data-stu-id="d8d91-141">Enabling Windows Azure authentication makes the following changes to your application:</span></span>

- <span data-ttu-id="d8d91-142">Une classe de falsification de requête intersite ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) ( *application\_Start\AntiXsrfConfig.cs* ) est ajoutée à votre projet.</span><span class="sxs-lookup"><span data-stu-id="d8d91-142">An Anti-Cross-Site Request Forgery ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) class ( *App\_Start\AntiXsrfConfig.cs* ) is added to your project.</span></span>
- <span data-ttu-id="d8d91-143">Les packages NuGet `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` sont ajoutés à votre projet.</span><span class="sxs-lookup"><span data-stu-id="d8d91-143">The NuGet packages `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` is added to your project.</span></span>
- <span data-ttu-id="d8d91-144">Les paramètres de Windows Identity Foundation dans votre application seront configurés pour accepter les jetons de sécurité de votre locataire Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d8d91-144">Windows Identity Foundation settings in your application will be configured to accept security tokens from your Windows Azure Active Directory tenant.</span></span> <span data-ttu-id="d8d91-145">Cliquez sur l’image ci-dessous pour afficher une vue développée des modifications apportées au fichier *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="d8d91-145">Click on the image below to see an expanded view of the changes made to the *Web.config* file.</span></span>

     ![](windows-azure-authentication/_static/image9.png)
- <span data-ttu-id="d8d91-146">Un principal de service pour votre application dans votre locataire Windows Azure Active Directory sera approvisionné.</span><span class="sxs-lookup"><span data-stu-id="d8d91-146">A service principal for your application in your Windows Azure Active Directory tenant will be provisioned.</span></span>
- <span data-ttu-id="d8d91-147">HTTPs est activé.</span><span class="sxs-lookup"><span data-stu-id="d8d91-147">HTTPS is enabled.</span></span>

## <a name="deploy-the-application-to-windows-azure"></a><span data-ttu-id="d8d91-148">Déployer l’application sur Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d8d91-148">Deploy the application to Windows Azure</span></span>

<span data-ttu-id="d8d91-149">Pour obtenir des instructions complètes, consultez [déploiement d’une application web ASP.net sur un site Web Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="d8d91-149">For complete instructions, see [Deploying an ASP.NET Web Application to a Windows Azure Web Site](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

<span data-ttu-id="d8d91-150">Pour publier une application à l’aide de l’authentification Windows Azure sur un site Web Azure :</span><span class="sxs-lookup"><span data-stu-id="d8d91-150">To publish an application using Windows Azure Authentication to an Azure Web Site:</span></span>

1. <span data-ttu-id="d8d91-151">Cliquez avec le bouton droit sur votre application, puis sélectionnez **publier :**</span><span class="sxs-lookup"><span data-stu-id="d8d91-151">Right click on your application and select **Publish:**</span></span>

    ![](windows-azure-authentication/_static/image3.jpg)
2. <span data-ttu-id="d8d91-152">Dans la boîte de dialogue publier le site Web, téléchargez et importez un profil de publication pour votre site Web Azure.</span><span class="sxs-lookup"><span data-stu-id="d8d91-152">From the Publish Web dialog download and import a publishing profile for your Azure Web Site.</span></span>

    ![](windows-azure-authentication/_static/image4.jpg)
3. <span data-ttu-id="d8d91-153">L’onglet **connexion** affiche l' **URL de destination** (URL publique pour votre application).</span><span class="sxs-lookup"><span data-stu-id="d8d91-153">The **Connection** tab shows the **Destination URL** (the public facing URL for your application).</span></span> <span data-ttu-id="d8d91-154">Cliquez sur **valider la connexion** pour tester votre connexion :</span><span class="sxs-lookup"><span data-stu-id="d8d91-154">Click **Validate Connection** to test your connection:</span></span>

    ![](windows-azure-authentication/_static/image5.jpg)
4. <span data-ttu-id="d8d91-155">Si vous avez déjà publié sur ce site Web Azure, vous pouvez vérifier le paramètre **Supprimer les fichiers supplémentaires à la destination** pour vous assurer que votre application est correctement publiée.</span><span class="sxs-lookup"><span data-stu-id="d8d91-155">If you have published to this Azure Web Site previously consider checking the **Remove additional files at destination** setting to ensure your application publishes cleanly.</span></span> <span data-ttu-id="d8d91-156">Notez que la case à cocher **activer l’authentification Windows Azure** est activée.</span><span class="sxs-lookup"><span data-stu-id="d8d91-156">Notice the **Enable Windows Azure Authentication** check box is selected.</span></span>

    ![](windows-azure-authentication/_static/image10.png)
5. <span data-ttu-id="d8d91-157">Facultatif : dans l’onglet **Aperçu** , cliquez sur **Démarrer l’aperçu** pour afficher les fichiers déployés.</span><span class="sxs-lookup"><span data-stu-id="d8d91-157">Optional: On the **Preview** tab click **Start Preview** to see the files deployed.</span></span>

    ![](windows-azure-authentication/_static/image6.jpg)
6. <span data-ttu-id="d8d91-158">Cliquez sur **publier.**</span><span class="sxs-lookup"><span data-stu-id="d8d91-158">Click **Publish.**</span></span>

    <span data-ttu-id="d8d91-159">Vous serez invité à activer l’authentification Windows Azure pour l’ordinateur hôte cible.</span><span class="sxs-lookup"><span data-stu-id="d8d91-159">You will be prompted to enable Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="d8d91-160">Cliquez sur **activer** pour continuer :</span><span class="sxs-lookup"><span data-stu-id="d8d91-160">Click **Enable** to continue:</span></span>

    ![](windows-azure-authentication/_static/image11.png)
7. <span data-ttu-id="d8d91-161">Entrez vos informations d’identification d’administrateur pour votre locataire Windows Azure Active Directory :</span><span class="sxs-lookup"><span data-stu-id="d8d91-161">Enter your administrator credentials for your Windows Azure Active Directory tenant:</span></span>

    ![](windows-azure-authentication/_static/image7.jpg)
8. <span data-ttu-id="d8d91-162">Une fois que votre application a été correctement publiée, un navigateur s’ouvre sur le site Web publié.</span><span class="sxs-lookup"><span data-stu-id="d8d91-162">Once your application has been successfully published, a browser will open to the published web site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d8d91-163">Cette opération peut prendre jusqu’à cinq minutes (généralement moins) pour que votre application soit entièrement configurée avec Windows Azure Active Directory après l’activation de l’authentification Windows Azure pour l’ordinateur hôte cible.</span><span class="sxs-lookup"><span data-stu-id="d8d91-163">It may take up to five minutes (typically must less) for your application to be fully provisioned with Windows Azure Active Directory after enabling Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="d8d91-164">Lorsque vous exécutez votre application pour la première fois, si vous recevez l’erreur ACS50001 : la partie de confiance portant le nom « [Realm] » est introuvable, attendez quelques minutes, puis réessayez d’exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="d8d91-164">When you first run your application if you receive error ACS50001: Relying party with name ‘[realm]' was not found, then wait a few minutes and try running the application again.</span></span>
9. <span data-ttu-id="d8d91-165">Lorsque vous y êtes invité, connectez-vous en tant qu’utilisateur dans votre répertoire :</span><span class="sxs-lookup"><span data-stu-id="d8d91-165">When prompted, log in as a user in your directory:</span></span>

    ![](windows-azure-authentication/_static/image8.jpg)
10. <span data-ttu-id="d8d91-166">Vous avez maintenant réussi à vous connecter à votre application hébergée par Azure à l’aide de l’authentification Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="d8d91-166">You have now successfully logged into your Azure hosted application using Windows Azure Authentication.</span></span>

     ![](windows-azure-authentication/_static/image9.jpg)

## <a name="known-issues"></a><span data-ttu-id="d8d91-167">Problèmes connus</span><span class="sxs-lookup"><span data-stu-id="d8d91-167">Known Issues</span></span>

#### <a name="role-based-authorization-fails-when-using-windows-azure-authentication"></a><span data-ttu-id="d8d91-168">L’autorisation basée sur les rôles échoue lors de l’utilisation de l’authentification Windows Azure</span><span class="sxs-lookup"><span data-stu-id="d8d91-168">Role-based authorization fails when using Windows Azure Authentication</span></span>

<span data-ttu-id="d8d91-169">L’authentification Windows Azure ne fournit pas actuellement la revendication de rôle nécessaire pour permettre l’exécution de l’autorisation basée sur les rôles.</span><span class="sxs-lookup"><span data-stu-id="d8d91-169">Windows Azure Authentication does not currently provide the necessary role claim so that role-based authorization can be performed.</span></span> <span data-ttu-id="d8d91-170">Le rôle de l’utilisateur authentifié doit être récupéré manuellement à partir de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d8d91-170">The role of the authenticated user must be manually retrieved from Windows Azure Active Directory.</span></span>

#### <a name="browsing-to-an-application-with-windows-azure-authentication-results-in-the-error-acs20016-the-domain-of-the-logged-in-user-livecom-does-not-match-any-allowed-domain-of-this-sts"></a><span data-ttu-id="d8d91-171">L’accès à une application avec l’authentification Windows Azure provoque l’erreur « ACS20016 le domaine de l’utilisateur connecté (live.com) ne correspond à aucun domaine autorisé de ce STS »</span><span class="sxs-lookup"><span data-stu-id="d8d91-171">Browsing to an application with Windows Azure Authentication results in the error "ACS20016 The domain of the logged in user (live.com) does not match any allowed domain of this STS"</span></span>

<span data-ttu-id="d8d91-172">Si vous êtes déjà connecté à un compte Microsoft (par exemple, hotmail.com, live.com, outlook.com) et que vous tentez d’accéder à une application qui a activé l’authentification Windows Azure, vous pouvez obtenir une réponse d’erreur 400, car le domaine de votre compte Microsoft n’est pas reconnu par Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d8d91-172">If you are already logged in to a Microsoft Account (for example hotmail.com, live.com, outlook.com) and you attempt to access an application that has enabled Windows Azure Authentication you may get a 400 error response because the domain of your Microsoft Account is not recognized by Windows Azure Active Directory.</span></span> <span data-ttu-id="d8d91-173">Pour vous connecter à l’application, déconnectez-vous d’abord de votre compte Microsoft.</span><span class="sxs-lookup"><span data-stu-id="d8d91-173">To log into the application, log out from your Microsoft Account first.</span></span>

#### <a name="logging-into-an-application-with-windows-azure-authentication-enabled-and-a-x509certificatevalidationmode-other-than-none-results-in-certificate-validation-errors-for-the-accountsaccesscontrolwindowsnet-certificate"></a><span data-ttu-id="d8d91-174">La connexion à une application avec l’authentification Windows Azure activée et une X509CertificateValidationMode autre que aucun génère des erreurs de validation de certificat pour le certificat accounts.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="d8d91-174">Logging into an application with Windows Azure Authentication enabled and a X509CertificateValidationMode other than None results in certificate validation errors for the accounts.accesscontrol.windows.net certificate</span></span>

<span data-ttu-id="d8d91-175">La validation du certificat n’est pas obligatoire et doit être laissée désactivée.</span><span class="sxs-lookup"><span data-stu-id="d8d91-175">Certificate validation is not required and should be left disabled.</span></span> <span data-ttu-id="d8d91-176">L’empreinte numérique du certificat de l’émetteur est validée par WSFederationAuthenticationModule.</span><span class="sxs-lookup"><span data-stu-id="d8d91-176">The thumbprint of the issuer certificate is validated by the WSFederationAuthenticationModule.</span></span>

#### <a name="when-attempting-to-enable-windows-azure-authentication-the-web-authentication-dialog-shows-the-error-acs20016-the-domain-of-the-logged-in-user-contosoonmicrosoftcom-does-not-match-any-allowed-domain-of-this-sts"></a><span data-ttu-id="d8d91-177">Lors d’une tentative d’activation de l’authentification Windows Azure, la boîte de dialogue d’authentification Web affiche l’erreur « ACS20016 : le domaine de l’utilisateur connecté (contoso.onmicrosoft.com) ne correspond à aucun domaine autorisé de ce STS. »</span><span class="sxs-lookup"><span data-stu-id="d8d91-177">When attempting to enable Windows Azure Authentication the Web Authentication dialog shows the error "ACS20016: The domain of the logged in user (contoso.onmicrosoft.com) does not match any allowed domain of this STS."</span></span>

<span data-ttu-id="d8d91-178">Vous pouvez voir cette erreur si vous vous êtes déjà connecté avec un compte Windows Azure Active Directory différent dans le même processus Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d8d91-178">You may see this error when you have previously successfully logged in using a different Windows Azure Active Directory account from within the same Visual Studio process.</span></span> <span data-ttu-id="d8d91-179">Déconnectez-vous du compte spécifié ou redémarrez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d8d91-179">Log out from the specified account or restart Visual Studio.</span></span> <span data-ttu-id="d8d91-180">Si vous avez déjà ouvert une session et sélectionné l’option « maintenir la connexion », vous devrez peut-être effacer les cookies de votre navigateur.</span><span class="sxs-lookup"><span data-stu-id="d8d91-180">If you previously logged in and selected the option to "Keep me signed in" then you may need to clear your browser cookies.</span></span>

## <a name="acs20012-the-request-is-not-a-valid-ws-federation-protocol-message"></a><span data-ttu-id="d8d91-181">ACS20012 : la demande n’est pas un message de protocole WS-Federation valide</span><span class="sxs-lookup"><span data-stu-id="d8d91-181">ACS20012: The request is not a valid WS-Federation protocol message</span></span>

<span data-ttu-id="d8d91-182">Cela peut se produire si vous êtes déjà connecté avec un autre ID Microsoft à l’un des services Azure.</span><span class="sxs-lookup"><span data-stu-id="d8d91-182">This can happen if you are already logged in with some other Microsoft ID to one of the Azure services.</span></span> <span data-ttu-id="d8d91-183">Utilisez une fenêtre de navigateur privée telle que non privée dans IE ou Incognito dans chrome ou désactivez tous les cookies.</span><span class="sxs-lookup"><span data-stu-id="d8d91-183">Use Private browser window like InPrivate in IE or Incognito in Chrome or clear all the cookies.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="d8d91-184">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="d8d91-184">Additional Resources</span></span>

- <span data-ttu-id="d8d91-185">[Outils Microsoft ASP.net pour Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="d8d91-185">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="d8d91-186">Fonctionnalités Windows Azure : identité</span><span class="sxs-lookup"><span data-stu-id="d8d91-186">Windows Azure Features: Identity</span></span>](https://docs.microsoft.com/azure/active-directory/)
- [<span data-ttu-id="d8d91-187">TechNet : Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d8d91-187">TechNet: Windows Azure Active Directory</span></span>](https://technet.microsoft.com/library/hh967619.aspx)
- [<span data-ttu-id="d8d91-188">Windows Azure Active Directory : développer des applications pour votre organisation</span><span class="sxs-lookup"><span data-stu-id="d8d91-188">Windows Azure Active Directory: Develop Apps for your organization</span></span>](https://activedirectory.windowsazure.com/Develop/Single-Tenant.aspx)
- [<span data-ttu-id="d8d91-189">Windows Azure Active Directory : développer des applications pour plusieurs organisations</span><span class="sxs-lookup"><span data-stu-id="d8d91-189">Windows Azure Active Directory: Develop Apps for multiple organizations</span></span>](https://activedirectory.windowsazure.com/Develop/Multi-Tenant.aspx)
- [<span data-ttu-id="d8d91-190">Comment implémenter l’authentification unique avec Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="d8d91-190">How to implement single sign-on with Windows Azure Active Directory</span></span>](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect)
- <span data-ttu-id="d8d91-191">[Authentification unique avec Windows Azure Active Directory : présentation approfondie](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="d8d91-191">[Single Sign-On with Windows Azure Active Directory: a Deep Dive](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="d8d91-192">Utiliser AD FS 2,0 pour implémenter et gérer l’authentification unique</span><span class="sxs-lookup"><span data-stu-id="d8d91-192">Use AD FS 2.0 to implement and manage single sign-on</span></span>](https://technet.microsoft.com/library/jj205462.aspx)
